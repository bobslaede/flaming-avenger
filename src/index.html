<!DOCTYPE html>
<html>
<head>
    <!-- build:js components.js -->
    <!-- endbuild -->
    <!-- build:css styles/main.css -->
    <link rel="stylesheet/less" href="styles/main.less">
    <script src="../node_modules/less/dist/less.js"></script>
    <!-- endbuild -->
</head>
<body class="fullbleed layout vertical">


<my-app></my-app>


<!-- build:remove -->
<script src="../node_modules/systemjs/dist/system.src.js"></script>
<script src="../node_modules/typescript/bin/typescript.js"></script>
<!--<script src="bower_components/es6-module-loader/dist/es6-module-loader-dev.src.js"></script>-->
<script>
    var defaultExtension = '.ts';

    var conf = {
        baseURL: './',
        transpiler: 'typescript',
        typescriptOptions: {
            noImplicitAny: true,
            removeComments: true,
            declaration: false,
            emitDecoratorMetadata: true,
            annotations: true
        },
        defaultExtension: false,
        paths: {
            'angular': 'lib/angular-shim.js',
            'angular-no-shim': '../node_modules/angular/angular.js'
        },
        meta: {
            'rx': {
                'format' : 'cjs'
            },
            'zone': {
                'format' : 'cjs'
            },
            'angular2': {
                deps: ['rx','zone']
            }
        }
    };

    for (var x in conf) {
        System[x] = conf[x];
    }

    var baseURI = window.location.href;
    baseURI = baseURI.split('#')[0].split('?')[0];
    baseURI = baseURI.substr(0, baseURI.lastIndexOf('/') + 1);

    var hasExt = function (file) {
        if (!file) return false;
        return ['js', 'ts'].indexOf(file.split('.').pop()) > -1;
    }

    var ext = function (file) {
        if (!file) return undefined;
        return hasExt(file) && ('.' + file.split('.').pop())
    }

    var norm = System.normalize;
    System.normalize = function (name, parent, parentAddress) {
        var parentExt = ext(parent);
        return Promise.resolve(norm.apply(System, arguments))
                .then(function (normed) {
                    if (normed.indexOf(baseURI) > -1) { // relative to this subpath
                        if (!ext(normed)) {
                            normed = normed + (parentExt || defaultExtension);
                        }
                    }
                    if (!ext(normed)) {
                        normed = normed + '.js'; // systemjs loader is fuk
                    }
                    return normed;
                })
    };

    System.import('./init.ts')
            .catch(console.error.bind(console));
</script>
<!-- endbuild -->

<!-- build:init -->
<!-- endbuild -->
</body>
</html>